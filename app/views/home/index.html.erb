<h1>LimitOS</h1>

homepage

<br><br>

<button id="on_button">On</button>
<button id="off_button">Off</button>

<br><br>

Status: <span id="device_status"></span>

<br><br>

<form id="servo_form">
  <input id="servo_input" placeholder="Servo position"></input>
  <button id="servo_button">Submit</button>
</form>

<script>
  $(document).ready(function() {

    // when the on button is clicked
    $('#on_button').click(function() {
      console.log('on button clicked');
      $.post('/devices/send_message', { message: { value: 'on' } });
    });

    // when the off button is clicked
    $('#off_button').click(function() {
      console.log('off button clicked');
      $.post('/devices/send_message', { message: { value: 'off' } });
    });

    // when the servo form is submitted
    $('#servo_form').submit(function() {
      sendServoMessage();
      // don't reload the page
      return false;
    });

    // subscribe to 'X'
    App.cable.subscriptions.create('DevicesChannel', {
      // when data is received
      received: function(data) {
        // log the data
        console.log(data);
        // update the status
        $('#device_status').text(JSON.stringify(data));
      }
    });

  });

  // send servo position
  function sendServoMessage() {
    $.post('/devices/send_message', {
      message: { servo: $('#servo_input').val() }
    });
  }
</script>
